<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="sale_stock.report_delivery_document_inherit_sale_stock" inherit_id="stock.report_delivery_document">
        <xpath expr="//h2" position="before">
            <div class="row justify-content-end" t-if="o.sudo().sale_id.client_order_ref">
                <div class="col-6">
                    <strong>Referencia del cliente:</strong>
                    <p t-field="o.sudo().sale_id.client_order_ref"/>
                </div>
            </div>
        </xpath>
    </template>

    <template id="report_delivery_document" inherit_id="stock_picking_report_valued.valued_report_picking">
        <xpath expr="//span[@t-field='o.date_done']" position="attributes">
            <attribute name="t-options">{"widget": "date"}</attribute>
        </xpath>
        <xpath expr="//span[@t-field='o.scheduled_date']" position="attributes">
            <attribute name="t-options">{"widget": "date"}</attribute>
        </xpath>
        <xpath expr="//span[@t-field='o.name']" position="before">
            <span>Albarán Nº: </span>
        </xpath>
        <xpath expr="//table" position="before">
            <t t-set="display_discount" t-value="any([l.sale_discount for l in o.move_line_ids])"/>
        </xpath>
        <xpath expr="//th[@groups='sale.group_discount_per_so_line']" position="attributes">
            <attribute name="t-if">display_discount</attribute>
        </xpath>
        <xpath expr="//td[@groups='sale.group_discount_per_so_line']" position="attributes">
            <attribute name="t-if">display_discount</attribute>
        </xpath>
    </template>

</odoo>
